{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport type { NextRequest } from \"next/server\"\r\nimport { createClient } from \"@/utils/supabase/middleware\"\r\n\r\nexport async function middleware(req: NextRequest) {\r\n  const res = NextResponse.next()\r\n  const supabase = createClient(req, res)\r\n\r\n  // Obtener usuario actual\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser()\r\n\r\n  const pathname = req.nextUrl.pathname\r\n\r\n  // âœ… Rutas protegidas (solo con sesiÃ³n)\r\n  const protectedRoutes = [\"/clinics\", \"/clinic-panel\"]\r\n\r\n  // Si no hay sesiÃ³n y quiere acceder a una ruta protegida â†’ redirigir a login\r\n  if (!user && protectedRoutes.some((path) => pathname.startsWith(path))) {\r\n    const redirectUrl = req.nextUrl.clone()\r\n    redirectUrl.pathname = \"/login\"\r\n    return NextResponse.redirect(redirectUrl)\r\n  }\r\n\r\n  // Si hay sesiÃ³n, obtener rol del usuario\r\n  if (user) {\r\n    const { data: profile } = await supabase\r\n      .from(\"profiles\")\r\n      .select(\"role\")\r\n      .eq(\"id\", user.id)\r\n      .single()\r\n\r\n    const role = profile?.role || \"paciente\"\r\n\r\n    // ðŸš« Bloquear acceso de pacientes al panel de clÃ­nicas\r\n    if (pathname.startsWith(\"/clinic-panel\") && role !== \"clinica\") {\r\n      const redirectUrl = req.nextUrl.clone()\r\n      redirectUrl.pathname = \"/clinics\"\r\n      return NextResponse.redirect(redirectUrl)\r\n    }\r\n\r\n    // ðŸš« (Opcional) Bloquear acceso de clÃ­nicas al Ã¡rea pÃºblica si lo prefieres\r\n    // if (pathname.startsWith(\"/clinics\") && role === \"clinica\") {\r\n    //   const redirectUrl = req.nextUrl.clone()\r\n    //   redirectUrl.pathname = \"/clinic-panel\"\r\n    //   return NextResponse.redirect(redirectUrl)\r\n    // }\r\n  }\r\n\r\n  return res\r\n}\r\n\r\n// Indica a Next.js en quÃ© rutas debe ejecutarse el middleware\r\nexport const config = {\r\n  matcher: [\"/clinics/:path*\", \"/clinic-panel/:path*\"],\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;;;;;;;AAIO,eAAe,WAAW,GAAgB;IAC/C,MAAM,MAAM,gMAAY,CAAC,IAAI;IAC7B,MAAM,WAAW,aAAa,KAAK;IAEnC,yBAAyB;IACzB,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,MAAM,WAAW,IAAI,OAAO,CAAC,QAAQ;IAErC,uCAAuC;IACvC,MAAM,kBAAkB;QAAC;QAAY;KAAgB;IAErD,6EAA6E;IAC7E,IAAI,CAAC,QAAQ,gBAAgB,IAAI,CAAC,CAAC,OAAS,SAAS,UAAU,CAAC,QAAQ;QACtE,MAAM,cAAc,IAAI,OAAO,CAAC,KAAK;QACrC,YAAY,QAAQ,GAAG;QACvB,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,yCAAyC;IACzC,IAAI,MAAM;QACR,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC7B,IAAI,CAAC,YACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;QAET,MAAM,OAAO,SAAS,QAAQ;QAE9B,uDAAuD;QACvD,IAAI,SAAS,UAAU,CAAC,oBAAoB,SAAS,WAAW;YAC9D,MAAM,cAAc,IAAI,OAAO,CAAC,KAAK;YACrC,YAAY,QAAQ,GAAG;YACvB,OAAO,gMAAY,CAAC,QAAQ,CAAC;QAC/B;IAEA,4EAA4E;IAC5E,+DAA+D;IAC/D,4CAA4C;IAC5C,2CAA2C;IAC3C,8CAA8C;IAC9C,IAAI;IACN;IAEA,OAAO;AACT;AAGO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAmB;KAAuB;AACtD"}}]
}